---
title: '维基化机制'
---

"维基化" 是一个通用术语，是将含有维基文本的条目，转换为浏览器所需的 HTML DOM 呈现的动态过程，和如果标的条目改变则更新呈现。

它由几个不同的步骤组成：

* [解析机制](ParsingMechanism)：读取条目本文并扫描维基文本构造，显示最终的结构的树状表示形式。这是一个昂贵的过程，因此将缓存分析树，并且仅在更改了相应的条目时，才需要更新
* [小工具机制](WidgetMechanism)：始于一个指定的根条目，为塑造一个渲染树的每个分析树节点，递归地实例化一个小工具。小工具也可以选择创建 DOM 节点。
* [刷新机制](RefreshMechanism)：有选择地、高效地更新渲染树，处理对条目存放区的更改

此机制用于在浏览器中构建 TiddlyWiki 的主交互页面。启动时，解析条目 $:/core/ui/PageTemplate 并呈现给 DOM，递归地拉入其他条目，以构建整个用户界面。任何用户交互 -- 跟随一个链接、点击一个按钮、或在文本方块中输入 -- 都会在条目存放区中触发更改，然后自动通过小工具树传播。 例如，如果用户按一下链接导航到新的条目，则运行以下步骤：

1. 按一下该链接将触发 LinkWidget 的操作，默认情况下，该操作是将目标条目，加到条目 $:/StoryList 的清单字段
1. 对条目存放区的修改，将异步触发刷新周期。即使连续修改了多个条目，异步触发可确保刷新周期仅运行一次
1. 刷新周期递归访问渲染树的每个节点，使其有机会根据对条目存放区的累积更改，来更新自己。在这种情况下，主故事河的 ListWidget 注意到需要向河流中添加单个条目，并呈现新显示的条目，而不会打扰其他条目

整个维基化过程的性能是至关重要的。如果刷新周期时间超过 400 毫秒左右，则用户会发现他们的动作和效果之间的延迟。参阅[性能](Performance)对于如何优化性能的一些讨论。

渲染过程也积极地重复用于 TiddlyWiki 的其他部分，无论是在浏览器和服务器上：

* 生成 TiddlyWiki 的独立 HTML 表示形式
* 创建条目的静态 HTML 呈现
* 动态呈现 CSS 样式表条目

