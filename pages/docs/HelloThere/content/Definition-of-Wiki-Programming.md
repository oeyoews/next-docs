---
title: Wiki编程的定义
---

class: autonumhead
created: 20230809234409764
creator: WhiteFall
modified: 20230903025847855
modifier: WhiteFall
tags: 插件开发 笔记思维
title: Wiki编程的定义

## 编程定义 

> "编程"是我们为了完成某项任务，将解决问题的步骤，用计算机能够理解的语言写成指令，这就是"编程"。而后，计算机会根据这些指令一步步执行，最后完成任务。

"编程"涉及到3个组成部分：

1. 我们，负责思考解决问题的步骤
1. 我们，负责使用计算机能够理解的语言，来描述解决的步骤
1. 计算机，负责执行这些步骤

## Wiki编程定义

什么是Wiki编程？（解释）

得益于三种两大类（编译和笔记）的维基文本解析器模式，以及部分Wiki解析语法，使得条目不仅可以用于写作还可以用于Wiki编程。Wiki编程是在条目中进行定义、调用不同形式的方法和变量，为了完成某种任务，将解决问题的步骤写成指令，使TiddlyWiki根据这些指令一步步执行，最后完成任务。

> 
> 开发框架/知识管理操作系统 > 插件开发 > wiki编程 > 笔记与写作。
> 
> [太微独特之处-技术部分]]、[[太微是开发框架/知识管理操作系统，不是笔记软件](太微与太记的区别)
> 
> 机制（Mechanisms）：组成 TiddlyWiki 的内部机制。
> 
> 级联（Cascades）是用于构建和自定义 TiddlyWiki 用户界面的关键机制。
> 

tree宏提供了一种Wiki编程参考。编辑器工具栏的文本片段snippet。似乎整个Wiki编程都围绕条目进行操作。之所以叫Wiki编程是因为，Wiki编程核心由js实现且降低了复杂度但又和平常的记录笔记相差较大，更类似一种功能实现，即它介于写作与编程语言之间，且偏向编程语言的方面。

Wiki编程核心是：小工具（Widget）[包含小工具消息（Messages）]、筛选器（Filters）、TiddlyWiki核心变量（包含于变量）、模块等，这些由TiddlyWiki提供的类API的工具或功能集。


小工具消息乃由小工具生成，以回应用户的操作。消息具有一个 name、一个可选的主要 parameter，以及一个或多个可选的命名参数。这些消息沿着小工具树向上传播，在那里它们由上层小工具或核心本身处理。小工具消息通常是触发式的，这意味着常常有一个小工具生成，另一个小工具处理。或者任意方式生成，生成此小工具消息的小工具处理。


### TW API & JS API

TW API就是TiddlyWiki提供定义好的微件（也称元素小工具，类似HTML元素）、微件消息（由微件提供）、筛选器、进程（宏，JS宏）、函数、核心变量、变量（$set $let $vars），模块（JS代码定义好的JS模块类型），提供所有功能的全部定义。

JS API就是TiddlyWiki JavaScript源代码级别的编程调用。

#### 使用范围

* 微件：wiki
* 微件消息：js，wiki
* 筛选器：js、wiki
* 进程：wiki
* 函数：wiki
* 核心变量：js、wiki
* 模块（JS模块类型）：js，wiki

同一个方法在不同的方法实现（微件、筛选器、JS等等）中可能有相同的功能。比如获取条目内容，你可以使用筛选器的`[tiddlerTitle]text[](#tiddlerTitle%5Dtext%5B)`，也可以使用js的`$tw.wiki.getTiddlerText(title)`。

微件是wiki编程的核心部分，它几乎独立与JS/TS编程部分，且自给自足，更像是一个服务于wiki和写作的编程语言。所以关于UI和视图的部分可以大胆交给它完成。你可以使用html和元素小工具混用，并使用相应功能的元素小工具替代html标签。比如button可以使用button微件代替、img可以使用image微件代替、input可以使用[定义输入框与变量](#%E5%AE%9A%E4%B9%89%E8%BE%93%E5%85%A5%E6%A1%86%E4%B8%8E%E5%8F%98%E9%87%8F)描述的代替等等。微件的目标结果感觉是视图。

若想要引入JS编程，模块（JS模块类型）是最好的选择，其中macro和widget两种JavaScript模块类型可以直接在条目中调用。最终无论如何，都是在条目中编程和调用。

### 方法

> Wiki编程中的方法有以下几种形式：进程（宏）、微件、函数

运用维基文本解析器有三种模式的其中一种：Pragmas（编译指示）在维基文本（条目）中定义不同形式的方法，提供对剩余文本解析方式的控制。也可以使用【模块】使用JavaScript实现对微件、宏模块类型的定义并在维基文本中调用。

剩余的两种解析器模式都是笔记的解析渲染和正常显示。

```tw
Pragma: \define
Pragma: \function
Pragma: \import
Pragma: \parameters
Pragma: \procedure
Pragma: \rules
Pragma: \whitespace
Pragma: \widget
```

进程（Procedures），可以接受参数变量。不同位置，变量是引用方式不一样。你可以使用小工具定义变量。也可以在某个小工具添加属性导出变量。在方法体中，你可以使用小工具、筛选器、小工具消息、变量进行一系列动作。

筛选器作用于所有条目的所有字段，它是对条目字段进行操作的方法。或者说访问并操作所有条目字段数据的函数。TiddlyWiki提供一种方法，查找哪些条目符合给定的模型。条目或数据条目作为原始数据集，函数、筛选器作为原始数据集的函数处理和筛选工具。

定义函数，函数在TiddlyWiki中被定义为包含筛选器表达式的命名文本片段。函数可以具有命名参数，这些参数在函数内当作变量使用。感觉基本上是操作条目的各个字段，对字段内容进行增查删改。然后输出一组内容，表现形式为编程语言中的列表类型。

元素微件`<$name>`，双尖括号`<<name>>`是两类基本的调用方式。
其中元素微件实现Wiki（条目）编程中对逻辑的控制。双尖括号`<<name>>`可以调用进程、自定义小工具、函数、宏。
所以若使用js语言，则一般用js定义这两类基本调用方式，然后再在条目中调用。

调用变量的行为取决于变量的声明方式。

### 变量

变量的定义（待修改）：变量是一个文本片段，可以通过名称访问。该文本称为变量的值。变量由小工具定义。几个内核小工具定义了变量，最常见的是 $set、$let 和 $list 小工具。

1. 过程的参数
1. 进程（宏）
1. 变量微件（$set、$let、$vars）
1. 函数
1. 核心变量

“TiddlyWiki核心变量”，这些变量是由TiddlyWiki提供好的，具有特殊功能，可以直接引用的。比如currentTiddler核心变量：`<$view tiddler=<<currentTiddler>> field=title/>`。

JavaScript变量与变量类型：

JS变量是用于存储信息的“容器”。

1. 基本类型（值类型）：字符串（String）、数字（Number）、布尔（Boolean）、空（Null）、未定义（Undefined）、Symbol
1. 对象类型（引用数据类型）：对象（Object）、数组（Array）、函数（Function）、正则（RegExp）、日期（Date）。

其中对象可以看做字典的键值对或JSON，数组可以看做列表。TW中常常采用者两种数据结构，比如条目和`<$list>`元素微件。

### 定义

1. 可以作为变量的过程定义：进程（宏、JS宏）、微件、函数；
1. 变量定义：$set、$let、$vars、核心变量；
1. 模块（JS模块类型）定义：包括所有TW API。例如：JS宏、微件、筛选器、通用模块等等

> <https://bramchen.github.io/tw5-docs/zh-Hans/#Variable%20Usage> 

* [定义微件和微件参数](#%E5%AE%9A%E4%B9%89%E5%BE%AE%E4%BB%B6%E5%92%8C%E5%BE%AE%E4%BB%B6%E5%8F%82%E6%95%B0)

### 调用

可以使用的调用：

1. 对条目与数据条目进行函数访问的筛选器
1. TW提供的或定义的过程（进程（宏）、微件、函数、小工具、小工具消息）和变量。

### 逻辑

Wiki编程的逻辑运算是通过什么实现的？微件和筛选器？

### 视图


TiddlyWiki 的显示是由一些底层的小工具驱动。这些小工具都组织成树状结构。小工具树是后续化为实际显示的中间表示。每个小工具的类别贡献一个特定功能，就像调用API一样。小工具提供 WikiText 更丰富的功能。它们与 HTML 元素 使用相同的标记方式，但是标记的名称前包含一个 $ 符号。小工具的属性因使用情景不同而被指定为多种不同形式。小工具是开始字符带有$符号，类似[HTML](https://developer.mozilla.org/zh-CN/docs/Learn/Getting_started_with_the_web/HTML_basics)文档中的元素标记，如`<$let><$let>`，使用这种标记生成专用的元素小工具。

> 现在，它不再使用 jQuery 和 DOM，而是将维基文本wikitext解析为通用的树形格式，然后将其渲染为文本 HTML。——TiddlyWiki5的诞生！

元素微件通常由 标记（tag）、属性（Attribute）、内容（Content）组成。可以将一个元素置于其他元素之中 —— 称作嵌套。通过指定标记和属性完成微件的方法调用，根据微件行为定义生成行为效果，若有返回值则并将返回值作用或传递到内容中，但微件内容也可以作为一种数据输入，由微件进行处理。

```html
<$set name="greeting" value="Hi">
	<$set name="me" value={{!!title}}>
		<$set name="sentence" value="helloworld" >
			<<greeting>>! I am <<me>> and I say: <<sentence>>
		</$set>
	</$set>
</$set>
```

### 调试

action-log、log小工具、[调试筛选器](#%E8%B0%83%E8%AF%95%E7%AD%9B%E9%80%89%E5%99%A8)

### 模块

> 为Wiki编程工具封装JS代码。

一个 TiddlyWiki5 的 模块 是包含可运行 JavaScript 的条目，其类型为`application/javascript`且其`modeule-type`字段为该模块的[模块类型]($:/core/ui/ControlPanel/LoadedModules)

### 条目

1. 数据条目
    1. 字典条目
    1. JSON条目

1. 系统条目
    1. 插件（条目组）
    1. 默认条目
    1. 模板条目
    1. 样式条目
    1. 配置条目
    1. 调色板条目

1. 普通条目